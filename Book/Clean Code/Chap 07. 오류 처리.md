# Chap 07. 오류 처리

> 오류 처리는 프로그램에 반드시 필요한 요소이다.  
> 흩어진 오류 처리 코드 때문에 실제 코드가 하는 일을 파악하기 어려울 수도 있으므로, 오류 처리는 매우 중요하다.

## 오류 코드보다 예외를 사용하라

오류 플래그를 설정하거나 호출자에게 오류 코드를 반환하는 방법은 호출자 코드가 복잡해질 수 있다. 함수가 **호출한 즉시 오류를 확인**해야 하기 때문이다.  
=> 예외를 던지도록 하면, 오류 처리 코드와 호출자 코드가 섞이지 않아 깔끔해진다.

```java
try{
    //호출자 코드
}catch(DeviceShutDownError e){
    //오류 처리 코드
}
```

## Try-Catch-Finally 문부터 작성하라

-   try, catch, finallu 구조로 범위를 정의하면 테스트 케이스를 작성하는데에도 도움이 된다.
-   강제로 예외를 일으키는 테스트 케이스를 작성한 후 테스트를 통과하게 코드를 작성하면, try 블록의 트랜잭션 범위부터 구현을 하게 되므로 트랜잭션의 본질을 유지하기 쉬워진다.

## 미확인 예외를 사용하라

-   확인된 예외가 유용한 상황이 있다.
-   하지만, 확인된 예외는 OCP(Open Closed Principle)을 위반한다.  
     메서드에서 확인된 예외를 던졌는데, catch 블록이 3단계 위에 있다면 그 사이 메서드 모두가 선언부에 해당 예외를 정의해야 한다.  
     => 하위 단계에서 코드를 변경하면 상위 단계 메서드 선언부를 전부 고쳐야 함  
     ==> 확인된 예외가 캡슐화를 깨버리는 현상이 발생

## 예외에 의미를 제공하라

-   오류 메세지에 정보를 담아 예외와 함께 던지면 오류가 발생한 원인과 위치를 찾기가 쉬워진다.
-   오류 메세지에 들어가면 좋은 정보: 실패한 연산의 이름, 실패한 유형 등...

## 호출자를 고려해 예외 클래스를 정의하라

-   오류를 분류하는 방법은 많다. (오류 발생 위치, 발생한 컴포넌트, 오류 유형 등..)
-   오류를 잡아내는 방법에 집중해야 한다.
-   외부 API를 사용할 때는 감싸기 기법이 최선이다.
    -   나중에 다른 라이브러리로 갈아탈 때도 비용이 적다.
    -   테스트도 쉽다.
    -   외부 API 설계 방식에 제약받지 않는다.

## 정상 흐름을 정의하라

## null을 반환하지 마라

-   특정 함수가 null을 반환하게 되면, 호출자는 반환 값을 사용 전에 null인지 확인하는 과정을 거쳐야 한다.
-   null인지 체크하는 과정이 빠지면 NullPointerException이 발생할지도 모른다.
-   null 반환은 null 체크 하는 코드가 길어지기 때문에 지양해야 한다.

## null을 전달하지 마라

-   메서드에서 null을 반환하는 것은 안 좋지만, 메서드에 null을 전달하는 것은 더 나쁘다.
-   정상적인 인수로 null을 기대하는 API가 아니라면 메서드로 null을 보내는 것은 지양해야 한다.  
    => 메서드가 인자를 받아서 null인지 아닌지 체크해야 하는 코드가 만들어진다.

## 결론

> 깨끗한 코드는 읽기도 좋아야 하지만, 안정성도 높아야 한다.  
> 오류 처리를 프로그램 논리와 분리해 독자적인 사안으로 고려하면 튼튼하고 깨끗한 코드를 작성할 수 있다.  
> 오류 처리를 프로그램 논리와 분리하면 독립적인 추론이 가능해지며 코드 유지보수성도 크게 노아진다.
